<% provide(:title, ' - ' + @user.username + '\'s gallery') %>
<h1>
  skuvo<span><%= link_to image_tag('/assets/glyphicons_upload.png'), root_path %></span>
</h1>
<% if current_user == @user %>
  <h2>
    Your Gallery 
  </h2>
  <ul class="tabs">
  <li class="active"><a href="#allimages">All Images (<span id="photosCount"><%= @photos.count %></span>)</a></li>
  <li><a href="#albums">Albums (<span id="albumsCount"><%= @albums.count %></span>)</a></li>
</ul> 
<% else %>
  <h2>
    <%= @user.username %>'s Gallery (<span id="photosCount"><%= @photos.count %></span>)
  </h2>
<% end %>

<div class="gallery">
  <div class="tab">
    <% if @photos.any? %>
      <% @photos.each do |photo| %>
        <div class="photoView" id="allimages">
          <a href="<%= photo.url %>">
            <img alt="skuvo uploaded image" class="photo" height="200" src="<%= photo.url %>/convert?fit=crop&amp;height=200&amp;width=200" width="200" />
          </a>
          <div>
            <input style="string" value="http://skuvo.com/<%= photo.short_url %>" size="30" readonly="readonly" onclick="this.select()">
          </div>
          <div class="photoButtons">
            <%= custom_tweet_button(image_tag('/assets/glyphicons_twitter.png'), {url: "http://www.skuvo.com/i/" + photo.short_url, text: "Check out this skuvo-uploaded image:"}, {id: 'tweet'}) %>
            <button data-fp-apikey="AWbWJDU7S82YMEcTRnbFwz" 
              data-fp-mimetype="image/png" 
              data-fp-url="<%= photo.url %>" 
              name="button" 
              type="submit">
              <img alt="Download image" id="download" src="/assets/glyphicons_download.png" />
            </button>
            <% if current_user == @user %>
              <span class="deleteButton">
                <%= link_to image_tag('/assets/glyphicons_remove.png', id: "delete", alt: "Delete Image"), photo, method: "delete", remote: true %>  
              </span>          
            <% end %>
          </div>
        </div>
      <% end %> 
    <% else %>
      <strong><%= @album ? "Album is empty" : "No uploaded images yet" %></strong>
    <% end %>
  </div> 
  <div class="tab" style="display:none">
    <div class="photoShow" id="albums">
      <% if @albums.any? %>
        <% @albums.each do |foobar| %>
          /a/<%= foobar.url %>
          
        <% end %>    
    <% elsif @albums.blank? && !@album && current_user == @user %>
      No albums created. Albums are automatically created when you upload more than 1 image at a time.
    <% end %> 
  </div>
</div>
  
  <% if @album %>
    <p id="albumText">
      <% if !current_user || current_user != @user %>
        <%= link_to "Signup to save your images", signup_path %>
      <% else %>
        <%= link_to "Return to " + @user.username + "'s gallery", username_path(@user.username) if @user %>
      <% end %>
    </p>
  <% end %>
</div>